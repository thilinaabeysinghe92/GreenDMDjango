/* jscow - Javascript Component Framework - jscow-splitter-1.0.0 - Mario Linz - http://www.jscow.de */jsCow.res.components.splitter=function(){};jsCow.res.components.splitter.prototype={init:function(){return this},setDefaultMVC:function(){this.setModel(jsCow.res.model.splitter);this.setView(jsCow.res.view.splitter);this.setController(jsCow.res.controller.splitter);return this},setSplitHorizontal:function(){this.globalEvents.trigger("setDirection",{direction:"horizontal"},this);return this},setSplitVertical:function(){this.globalEvents.trigger("setDirection",{direction:"vertical"},this);return this},setSplitterConfig:function(a){this.globalEvents.trigger("setSplitterConfig",a,this);return this},setSplitterSizes:function(a){this.globalEvents.trigger("setSplitterSizes",a,this);return this},getSplitterSizes:function(){var a=this.getModel().getConfig();var a=a.splitterConfiguration.sizes;return a},setResizer:function(a){this.globalEvents.trigger("setResizer",a,this);return this},getResizer:function(){var a=this.getModel().getConfig();var a=sizes.splitterConfiguration.resizer;return a}};jsCow.res.model.splitter=function(){this.type="jsCow.res.model.splitter";this.config={globalDisabled:false,enabled:true,direction:"vertical",splitterConfiguration:{},calculatedChildSizes:[]}};jsCow.res.model.splitter.prototype={init:function(){var a=this;this.getCmp().getApp().addWindowEvent({resize:function(b){a.globalEvents.trigger("windowResize",b)}});this.globalEvents.trigger("viewInit",this.getConfig(),this.getCmp())},initialAppEvent:function(a){if(this.isEnabled()){this.setInnerWidth(this.getCmp().getParent().getInnerWidth(true));this.setInnerHeight(this.getCmp().getParent().getInnerHeight(true));this.getCmp().getView().call("setSplitterSizes",this.getConfig());this.getCmp().getView().call("setOrientation",this.getConfig());this.getCmp().getView().call("createSplitterResizer",this.getConfig());this.getCmp().getView().call("calculateSizes",this.getConfig())}return this},update:function(a){if(this.isEnabled()){this.windowResize(a)}return this},windowResize:function(a){if(this.isEnabled()){this.setInnerWidth(this.getCmp().getParent().getInnerWidth(true));this.setInnerHeight(this.getCmp().getParent().getInnerHeight(true));this.getCmp().getView().call("setSplitterSizes",this.getConfig());this.getCmp().getView().call("calculateSizes",this.getConfig())}return this},setDirection:function(a){if(this.isEnabled()){this.setConfig({direction:a.data.direction});this.globalEvents.trigger("viewUpdate",this.getConfig(),this.getCmp())}return this},setSplitterConfig:function(a){if(this.isEnabled()){this.setConfig({splitterConfiguration:a.data});this.globalEvents.trigger("viewUpdate",this.getConfig(),this.getCmp())}return this},setSplitterSizes:function(a){if(this.isEnabled()){this.setConfig({splitterConfiguration:{sizes:a.data}});this.update(a)}return this},setResizer:function(a){if(this.isEnabled()){$.extend(this.config.splitterConfiguration.resizer,a.data);this.getCmp().getView().call("update",this.getConfig())}return this},resizerDraggableStop:function(d){if(this.isEnabled()){var a=this;var c=this.getConfig("direction");var b=this.getConfig("splitterConfiguration").sizes;$.each(this.getConfig("resizer"),function(g,h){if(h&&d.data.resizer.getID()==h.getID()){if(c=="horizontal"){var f=d.data.resizer.getView().getDomMain().prev().outerWidth(true);if(d.data.clone.posX<d.data.org.posX){var j=d.data.org.posX-d.data.clone.posX;var e=f-j}else{var j=d.data.clone.posX-d.data.org.posX;var e=f+j}if(e<0){e=1}b[g]=a.convertSize(b[g],e,a.getCmp().getInnerWidth())}else{var f=d.data.resizer.getView().getDomMain().prev().outerHeight(true);if(d.data.clone.posY<d.data.org.posY){var j=d.data.org.posY-d.data.clone.posY;var e=f-j}else{var j=d.data.clone.posY-d.data.org.posY;var e=f+j}if(e<0){e=1}b[g]=a.convertSize(b[g],e,a.getCmp().getInnerHeight())}}});this.update()}return this},convertSize:function(c,a,b){if(c&&a&&c!=undefined&&a!=undefined&&b!=undefined){var c=String(c);var a=String(a);var b=String(b);if(c.indexOf("%")>0){return parseInt((a/b)*100)+"%"}else{if(c.indexOf("px")==0||c.indexOf("px")>0){return parseInt(a)}else{if(c=="auto"){return"auto"}else{return parseInt(a)}}}}else{return"auto"}}};jsCow.res.view.splitter=function(){this.execInit=false;this.type="jsCow.res.view.splitter";this.dom={};this.dom.main=$("<div/>").addClass("jscow-splitter clearfix");this.dom.content=$("<div/>").addClass("jscow-splitter-content clearfix").appendTo(this.dom.main);this.config={resizer:[]}};jsCow.res.view.splitter.prototype={init:function(a){var a=a.data;var b=this;this.getCmp().getApp().addWindowEvent({resize:function(c){window.setTimeout(function(){b.getCmp().getApp().globalEvents.bubbleDown("windowResize",c)},0)}})},update:function(a){var a=a.data;if(a){if(!a.enabled||a.globalDisabled){this.dom.main.addClass("jscow-splitter-disabled").removeClass("jscow-splitter")}else{this.dom.main.addClass("jscow-splitter").removeClass("jscow-splitter-disabled");this.setOrientation({data:a});this.createSplitterResizer({data:a});this.calculateSizes({data:a});if(a.hide){this.dom.main.addClass("jscow-hide")}else{this.dom.main.removeClass("jscow-hide")}}}return this},createSplitterResizer:function(d){var b=this;var a=d.data;var c=this.getCmp().getChildren();if(c.length>1&&a.splitterConfiguration&&a.splitterConfiguration.resizer.length){$.each(c,function(e,g){if(e<c.length-1){var f=g.getView().getViewList();$.each(f,function(i,h){if(a.splitterConfiguration.resizer[e]){if(b.config.resizer[e]==undefined||!b.config.resizer[e]){if(a.direction=="horizontal"){b.config.resizer[e]=jsCow.components.get(jsCow.res.components.resizer).setHorizontalOrientation()}else{b.config.resizer[e]=jsCow.components.get(jsCow.res.components.resizer).setVerticalOrientation()}b.config.resizer[e]=b.getCmp().appendAfterInner(b.config.resizer[e],g)}else{if(b.config.resizer[e]){if(a.direction=="horizontal"){b.config.resizer[e].setHorizontalOrientation()}else{b.config.resizer[e].setVerticalOrientation()}}}}else{if(!a.splitterConfiguration.resizer[e]){if(b.config.resizer[e]){b.config.resizer[e].del()}b.config.resizer[e]=false}}})}})}this.getCmp().getModel().setConfig({resizer:this.config.resizer})},size2Px:function(a,b){if(a&&a!=undefined&&b!=undefined){var a=String(a);var b=String(b);if(!a){a="0px"}if(a.indexOf("%")>0){var a=a.replace("%","");return parseInt((b*a)/100)}else{if(a.indexOf("px")>0){return parseInt(a)}else{return parseInt(a)}}}else{return"0px"}},setOrientation:function(c){var a=c.data;var b=this.getCmp().getChildren();$.each(b,function(d,e){if(a.direction=="horizontal"){if(e.getModel().getType()!="jsCow.res.model.resizer"){e.getView().getDomMain().removeClass("clearfix");e.getView().getDomMain().addClass("jscow-float-left jscow-splitter-crop")}else{if(e.getModel().getType()=="jsCow.res.model.resizer"){e.setHorizontalOrientation()}}}else{if(e.getModel().getType()!="jsCow.res.model.resizer"){e.getView().getDomMain().addClass("clearfix");e.getView().getDomMain().removeClass("jscow-float-left jscow-splitter-crop")}else{if(e.getModel().getType()=="jsCow.res.model.resizer"){e.setVerticalOrientation()}}}})},setSplitterSizes:function(b){var a=b.data;this.getContent().width(a.__innerWidth__).height(a.__innerHeight__)},calculateSizes:function(g){if(typeof this.getCmp().getParent()=="object"){var c=this;var b=g.data;var d=this.getCmp().getChildren();var h=0;var f=0;var a=[];if(b.splitterConfiguration.sizes==undefined){b.splitterConfiguration.sizes=[]}if(b.direction=="horizontal"){f=this.getCmp().getInnerWidth()}else{f=this.getCmp().getInnerHeight()}$.each(this.config.resizer,function(e,j){if(j){if(b.direction=="horizontal"){f=f-j.getView().getDomMain().outerWidth(true)}else{f=f-j.getView().getDomMain().outerHeight(true)}}});$.each(d,function(j,k){if(b.splitterConfiguration.sizes[j]){if(b.splitterConfiguration.sizes[j]&&b.splitterConfiguration.sizes[j]!="auto"){if(String(b.splitterConfiguration.sizes[j]).indexOf("%")>0){if(b.direction=="horizontal"){var e=c.size2Px(b.splitterConfiguration.sizes[j],f)}else{var e=c.size2Px(b.splitterConfiguration.sizes[j],f)}}else{var e=c.size2Px(b.splitterConfiguration.sizes[j],f)}if(b.direction=="horizontal"){if(k.getModel().getType()!="jsCow.res.model.resizer"){a[j]={width:e,height:c.getCmp().getInnerHeight()}}f=parseInt(f-e)}else{if(k.getModel().getType()!="jsCow.res.model.resizer"){a[j]={width:c.getCmp().getInnerWidth(),height:e}}f=parseInt(f-e)}if(f<0){f=0}}else{if(b.splitterConfiguration.sizes[j]){h++}}}});$.each(d,function(e,j){if(b.splitterConfiguration.sizes[e]&&b.splitterConfiguration.sizes[e]=="auto"){if(b.direction=="horizontal"){if(j.getModel().getType()!="jsCow.res.model.resizer"){a[e]={width:(f/h),height:c.getCmp().getInnerHeight()}}}else{if(j.getModel().getType()!="jsCow.res.model.resizer"){a[e]={width:c.getCmp().getInnerWidth(),height:(f/h)}}}}});this.getCmp().getModel().setConfig({calculatedChildSizes:a});this.dom.content.addClass("jscow-overflow-hidden");$.each(d,function(e,j){if(b.splitterConfiguration.sizes[e]){if(j.getModel().getType()!="jsCow.res.model.resizer"){j.setWidth(a[e].width);j.setHeight(a[e].height);j.getView().getDomContent().width(Math.floor(a[e].width));j.getView().getDomContent().height(Math.floor(a[e].height));this.globalEvents.trigger("update",b,j)}}if(j.getModel().getType()=="jsCow.res.model.resizer"){this.globalEvents.trigger("update",b,j)}});this.dom.content.removeClass("jscow-overflow-hidden")}}};jsCow.res.controller.splitter=function(){this.type="jsCow.res.controller.splitter"};jsCow.res.controller.splitter.prototype={init:function(){},handleInitialAppEvent:function(a){if(this.isMethodExists(this.getModel().initialAppEvent)){this.getModel().initialAppEvent(a)}return this},handleSetDirection:function(a){if(this.isMethodExists(this.getModel().setDirection)){this.getModel().setDirection(a)}return this},handleWindowResize:function(a){if(this.isMethodExists(this.getModel().windowResize)){this.getModel().windowResize(a)}return this},handleSetSplitterConfig:function(a){if(this.isMethodExists(this.getModel().setSplitterConfig)){this.getModel().setSplitterConfig(a)}return this},handleSetSplitterSizes:function(a){if(this.isMethodExists(this.getModel().setSplitterSizes)){this.getModel().setSplitterSizes(a)}return this},handleSetResizer:function(a){if(this.isMethodExists(this.getModel().setResizer)){this.getModel().setResizer(a)}return this},handleResizerDraggableStop:function(a){if(this.isMethodExists(this.getModel().resizerDraggableStop)){this.getModel().resizerDraggableStop(a)}return false}};